Letörné a cross-site scripting támadásokat a Mozilla

Az IBM idén februárban publikált 2008-as biztonsági jelentése szerint cross-site scripting (XSS) a második leggyakoribb webes támadási módszert jelentette tavaly, míg a megelõzõ években egyértelmûen a legnépszerûbb volt a bûnözõk körében, vagyis egy aktív online életet élõ PC-felhasználó számára valószínûleg a legnagyobb fenyegetést jelentették az ilyen jellegû kockázatok. Kihasználva az elhanyagoltan konfigurált és résekkel teli webszerverek tömegét, a rosszindulatú kódot a weblapokba injektáló XSS veszélye, hogy olyan oldalakat is veszélyessé tehet, melyeket ismerünk, és melyekben látatlanban megbízunk.
Ennek akar véget vetni a Mozilla, mégpedig a tartalomra vonatkozó biztonsági szabályok bevezetésével. A mai net még mindig az eredetileg megbízható hosztokból felépülõ ARPANET-et és a CERN tudósainak információmegosztását támogató mikrowebet alapul véve kidolgozott protokollokra épít, melyek tervezésekor nem volt szempont az autentikáció és biztonság. Ebbõl fakadóan a weben minden tartalom egyenértékû, a weblapok tervezésében nem jelennek meg biztonsági szempontok, a böngészõk pedig nem tesznek különbséget letöltött tartalmak közt, forrástól és a kód jellegétõl függetlenül fogadnak mindent.
Ennek vetne véget a Mozilla, mégpedig a tartalmombiztonsági szabályrendszer (CSP, content security policy) bevezetésével. A cross site scripting támadások kivitelezését az teszi lehetõvé, hogy minden tartalmat azonos, lényegében a legmagasabb jogosultsági szinten kezelik a böngészõk. A CSP nem tesz mást, minthogy megmondja a böngészõnek, melyik kód legitim, és melyik nem az, így figyelmen kívül lehet hagyni ártó kódokat. Mindez önmagában nem elegendõ, a CSP újfajta weblaptervezési megközelítést, architektúrát igényel. Ennek alapja, hogy a jövõben minden JavaScriptnek külsõ, megbízható forrásból kell betöltõdnie, és tiltottak a beágyazott szkriptek.


A Firefox fejlesztõi ugyanakkor tudatában vannak, hogy ez túlságosan drasztikus változás ahhoz, hogy gyorsan és tömegesen meg lehessen valósítani. Emiatt a a Mozilla számos eszközzel ruházta fel a CSP-t, hogy egy összetett szabályrendszerrel, felkészültségének függvényében tudja a tartalomszolgáltató beállítani a biztonsági szintet. Brandon Sterne, a Mozilla biztonságprogramjának menedzsere állítja, nem tudnak olyan weboldalról, melyre ne lehetne alkalmazni a CSP-t.
Mivel egy kizárólag kliensoldali tartalmi tûzfalon a legtöbb, ha nem az összes weblap fennakadna, ezért a Mozilla CSP-je szerveroldalról szabályozza az aktuális házirendet, vagyis elküldi a házirendet elõször a kliensnek, mely ez alapján fogadja. Mikor ellátogatunk egy weblapra, a böngészõ betölti a szabályokat, majd ez alapján értékeli ki az oldal tartalmát, így például kizárólag a megengedett forrásokból tölt be képeket, médiát, szkriptet, CSS-t vagy kereteket. Hogy az XSS támadásokat hatékonyabban felderítsék az adminisztrátorok, megadhatnak riportokat fogadó erõforrást, mely XML-ben várja a meghatározott szabályokkal szembe kerülõ incidensekrõl készült összefoglalót. További részletek a CSP lapján olvashatók.	     
                  
                  
                  
                   