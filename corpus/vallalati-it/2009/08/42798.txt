Masszívan párhuzamos a Sun következõ processzora

A Szilícium-völgyben tartott Hot Chips konferencián nem csak az IBM ismertette Power7 processzorának legfontosabb újdonságait, a Sun is szolgált érdekességekkel. Az Oracle kezébe kerülõ cég nem az azóta törölt Rockról, hanem a Niagara soron következõ generációjáról, a Rainbow Falls kódnevû chiprõl hozott nyilvánosságra információkat. Frissítés: a cikkben pontosítottuk a szálkezeléssel és memóriavezérlõvel kapcsolatos információkat. A hibákért elnézést kérünk.
Fokozódó sûrûség
A kanadai Ontario államban található vízesésrõl elnevezett Rainbow Falls a masszív párhuzamosságra fejlesztett Niagara termékcsalád újabb tagja, minden eddiginél több maggal és programszállal. A Rainbow Falls összesen 16 processzormagot tartalmaz, amelyek lényegében az UltraSPARC T2 magjait viszik tovább, továbbra is egyenként 8 párhuzamos szál futtatására képesek, vagyis egyetlen chip 128 szálat kezel egyszerre. A Hot Chipsen bemutatott prezentáció tévesen állította, hogy megduplázták volna a magonkénti fonalak számát, ahogyan a cikk eredetileg állította is. A hibáért elnézést kérünk.
A magok szintjén kisebb fejlesztések történtek csak. Sanjay Patel, a Sun processzortervezõ mérnökének beszámolója szerint a mérnökök tovább finomították a lebegõpontos egységeket, illetve teljesen áttervezték a kriptográfiai motort, amely hardveres gyorsítást kínál a leggyakoribb titkosítóalgoritmusokhoz. A Rainbow Falls a hírek szerint már az SHA-2 és a mobiltelefóniában használt KASUMI algoritmust is képes hardveresen gyorsítani. A chip minden magja tartalmaz egy ilyen kriptográfiai gyorsító koprocesszort, amelyeket speciális utasításokon keresztül "soron kívül" is el lehet érni.
A lapkát már nem a Texas Instruments, hanem a TSMC fogja gyártani, a tervek szerint 40 nanométeres csíkszélességgel, amelynek köszönhetõen a chip fizikai mérete nagyjából hasonló lesz a 65 nanométeres UltraSPARC T2  processzoréhoz, viszont közel harmadával többet fogyaszt majd - derül ki Patel elõadásából. Órajeleket nem hozott nyilvánosságra a vállalat, vélhetõen azért sem, mert ez a kihozatalok alapján késõbb fog véglegesedni.
Skálázódás
Patel szerint az igazi áttörést nem maguk a magok jelentik, hanem a rengeteg párhuzamos programszál futtatásához és összehangolásához szükséges támogatás létrehozása. A Sunnál számtalan trükköt bevetettek annak érdekében, hogy a koherenciaforgalmat minimálisra csökkentsék a többfoglalatos rendszerekben, így megmaradhat a glueless felépítés, vagyis a processzorokat közvetlenül, külsõ chipset nélkül egymáshoz lehet kapcsolni.
A Rainbow Falls 16 magja dedikált L2 gyorsítótárat kap, harmadszintû cache viszont a korábbi UltraSPARC T-sorozatú chipekhez hasonlóan nem kerül a chipre, ennek valószínûleg helytakarékossági okai vannak. Egy-egy processzorban két független koherencia hordozóréteg található, melyek a fizikai címtartomány partícióinak foghatóak fel, és egy-egy DDR3 memóriavezérlõhöz (szakítva az FB-DIMM-mel, szemben a cikk eredeti állításával), valamint 8-8 L2 bankhoz kötõdnek - amirõl nem esett szó, hogy ezek a memóriavezérlõk továbbra is kétcsatornásak-e, és mekkora sávszélességeket támogatnak. Az L2 bankokhoz a magok egy központi crossbaron, vagyis mátrix szervezésû kapcsolón keresztül kapcsolódnak megosztottan, méghozzá párosával kapnak meg egy portot a chip switchén.

A Rainbow Falls processzor koherenciarétege
Egy koherencia-hordozóréteg három linkkel kapcsolódik a külvilághoz, és egyidejûleg összesen 1024 tranzakciót képes lekezelni. A linkek képességeirõl Patel nem beszélt, mindössze annyit lehet tudni, hogy alacsony késleltetésû, nagy sebességû összeköttetésekrõl van szó. A prezentáció alapján a Rainbow Falls négy foglalatig skálázódik glueless módon, minden hordozópár további három chiphez képes kapcsolódni. A chip ugyanakkor elvileg alkalmas arra is, hogy diszkrét chipsettel együttmûködve rendszerszintû routingot kapjon, vagyis az adatkoherencia kezelésébe külsõ logika is beavatkozna. Patel elmondása szerint ez volt az egyik legfõbb kihívás, hogy minden kiépítésben egy rugalmasan konfigurálható, skálázódó rendszert kapjanak, mely képes akár 64 magot és 1024 fonalat is támogatni egyetlen rendszerben.
Hova tovább?
A Niagara-család tagjaira épülõ szerverek ugyan egyre nagyobb népszerûségnek örvendenek, de ezeket zömével a meglevõ SPARC-alapú rendszerek konszolidációjára vásárolják, és csak viszonylag kevés új ügyfelet tudnak a Sunnak megnyerni. Ezzel együtt a vállalat negyedévente már 300 millió dollárnál több forgalmat realizál UltraSPARC T-alapú szerverek értékesítésébõl, a termékkategória ma már meghatározó tagja a Sun kínálatának.

Jelenleg nem tudni, egy ilyen extrém párhuzamosságra fejlesztett, 16 magos, 128 szálat kezelõ processzor mennyire lehet sikeres a piacon. A magok számának növekedése ugyanis bizonyos szoftverlicencek költségére is kihatással van, számos szerverszoftver ára ugyanis a programot futtató gép processzormagjainak számától is függ. Hiába képes a Rainbow Falls egyetlen chipen annyi szálat kezelni, amelyhez ma még egy komplett racknyi blade-re van szükség, ha a teljesítménynövekedés sok esetben csak a szoftverlicencek drámai emelkedése révén érhetõ el.
A jelenleg és közeljövõben várható szoftverek skálázódása láthatóan  a hardverek mögött kullog, ezért fontos lenne az egyszálú teljesítmény növelése, az pedig a legtöbb üzleti alkalmazás alatt aligha javul pusztán a továbbfejlesztett lebegõpontos egységtõl és a jobb kriptográfiai gyorsítótól. Órajelekrõl Patel nem beszélt, a Sun UltraSPARC T2  jelenleg 1,6 GHz-nél jár 65 nanométeres csíkszélességen, a Rainbow Falls a HWSW becslései szerint legfeljebb 1,8-2 GHz körüli órajelen debütálhat. A jövõbeni fejlesztési iránnyal kapcsolatban a Sun a Niagara vonal egyre általánosabb célú alkalmazhatóságáról beszél, és vélhetõen a Niagara lesz az alapja  a cég jelenleg formálódó új felsõ kategóriás szerverprocesszorához, melyrõl egyelõre mélyen hallgat a vállalat.
Egyelõre ugyanakkor még sem világos, hogy a Rainbow Fallsból az Oracle égisze alatt lesz-e termék, vagy az UltraSPARC T-család új tagja mindörökre papíron marad - a prezentáció ténye azonban bátorító. Larry Ellison, az Oracle vezére ugyan hangsúlyozta, hogy építeni akar a Sun hardverrészlegére, de eddig még nem hozták nyilvánosságra az integrációs terveket, nem tudni hogy a Sun részlegeivel és termékeivel kapcsolatban mik az Oracle elképzelései. Jelenleg nem tudni, a Rainbow Falls mikor jelenhet meg, de a Rock törlésével alighanem minél fontosabbá vált a Sun számára, hogy hamar elõrukkoljon vele, így jövõ év tavaszára, két évvel a Victoria Falls megjelenése utánra remélhetõ.	     
                  
                  
                  
                   